import{_ as z,r as s,a as G,c as I,o as E,w as O,b as v,d as B,e as t,f as e,g as u,t as C,u as D,h as L,i as k,j as Y,k as $,E as P}from"./index-Dv7cJHYD.js";import{f as w,g as U,u as j}from"./maintenance-9LlAq3Of.js";const A={class:"pagination"},H={__name:"MaintenanceTable",props:{data:Array,loading:Boolean,currentPage:Number,pageSize:Number,total:Number},emits:["page-change","view-detail","delete-item"],setup(m,{emit:b}){const l=b,n=c=>({PENDING:"即将开始",ONGOING:"进行中",COMPLETED:"已完成"})[c]||c,M=c=>{l("page-change",c)},V=c=>{l("view-detail",c)},_=c=>{l("delete-item",c)};return(c,d)=>{const r=s("el-table-column"),T=s("el-tag"),h=s("el-button"),y=s("el-popconfirm"),i=s("el-table"),a=s("el-pagination"),g=G("loading");return E(),I("div",null,[O((E(),B(i,{data:m.data},{default:t(()=>[e(r,{prop:"title",label:"标题",width:"200"}),e(r,{label:"维护时段",width:"300"},{default:t(({row:o})=>[u(C(D(w)(o.startTime))+" → "+C(D(w)(o.endTime)),1)]),_:1}),e(r,{label:"状态"},{default:t(({row:o})=>[e(T,{type:D(U)(o.status),class:"status-tag"},{default:t(()=>[u(C(n(o.status)),1)]),_:2},1032,["type"])]),_:1}),e(r,{label:"创建时间",width:"180"},{default:t(({row:o})=>[u(C(D(w)(o.createdAt)),1)]),_:1}),e(r,{label:"操作",width:"180"},{default:t(({row:o})=>[e(h,{size:"small",onClick:p=>V(o)},{default:t(()=>d[0]||(d[0]=[u("查看")])),_:2,__:[0]},1032,["onClick"]),e(y,{title:"确定删除该公告?",onConfirm:p=>_(o.id)},{reference:t(()=>[e(h,{size:"small",type:"danger",disabled:o.status!=="PENDING"},{default:t(()=>d[1]||(d[1]=[u(" 删除 ")])),_:2,__:[1]},1032,["disabled"])]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[g,m.loading]]),v("div",A,[e(a,{"current-page":m.currentPage,"page-size":m.pageSize,total:m.total,onCurrentChange:M,layout:"prev, pager, next, jumper"},null,8,["current-page","page-size","total"])])])}}},F=z(H,[["__scopeId","data-v-bef32424"]]),q={class:"app-container"},J={class:"header"},K={class:"search-bar"},Q={class:"main-content"},W={__name:"ListView",setup(m){const b=$(),l=j();l.phase2Enabled;const n=L({title:"",timeRange:[],status:""}),M=k(()=>l.notices),V=k(()=>l.loading),_=k(()=>l.pagination);Y(()=>{l.fetchMaintenanceNotices()});const c=()=>{const i={title:n.value.title,status:n.value.status};n.value.timeRange&&n.value.timeRange.length===2&&(i.startTime=n.value.timeRange[0],i.endTime=n.value.timeRange[1]),l.fetchMaintenanceNotices(i)},d=()=>{n.value={title:"",timeRange:[],status:""},l.fetchMaintenanceNotices()},r=i=>{l.pagination.page=i,l.fetchMaintenanceNotices()},T=()=>{b.push({name:"create"})},h=i=>{b.push({name:"detail",params:{id:i.id}})},y=async i=>{await l.deleteMaintenanceNotice(i)?(P.success("公告删除成功"),l.fetchMaintenanceNotices()):P.error("公告删除失败")};return(i,a)=>{const g=s("el-button"),o=s("el-input"),p=s("el-form-item"),R=s("el-date-picker"),N=s("el-option"),x=s("el-select"),S=s("el-form");return E(),I("div",q,[v("div",J,[a[4]||(a[4]=v("h1",null,"维护公告管理",-1)),e(g,{type:"primary",onClick:T},{default:t(()=>a[3]||(a[3]=[u("新增公告")])),_:1,__:[3]})]),v("div",K,[e(S,{inline:!0,model:n.value},{default:t(()=>[e(p,{label:"公告标题"},{default:t(()=>[e(o,{modelValue:n.value.title,"onUpdate:modelValue":a[0]||(a[0]=f=>n.value.title=f),placeholder:"输入标题关键字",clearable:""},null,8,["modelValue"])]),_:1}),e(p,{label:"维护时间"},{default:t(()=>[e(R,{modelValue:n.value.timeRange,"onUpdate:modelValue":a[1]||(a[1]=f=>n.value.timeRange=f),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),e(p,{label:"状态"},{default:t(()=>[e(x,{modelValue:n.value.status,"onUpdate:modelValue":a[2]||(a[2]=f=>n.value.status=f),placeholder:"全部"},{default:t(()=>[e(N,{label:"全部",value:""}),e(N,{label:"即将开始",value:"PENDING"}),e(N,{label:"进行中",value:"ONGOING"}),e(N,{label:"已完成",value:"COMPLETED"})]),_:1},8,["modelValue"])]),_:1}),e(p,null,{default:t(()=>[e(g,{type:"primary",onClick:c},{default:t(()=>a[5]||(a[5]=[u("查询")])),_:1,__:[5]}),e(g,{onClick:d},{default:t(()=>a[6]||(a[6]=[u("重置")])),_:1,__:[6]})]),_:1})]),_:1},8,["model"])]),v("div",Q,[e(F,{data:M.value,loading:V.value,"current-page":_.value.page,"page-size":_.value.pageSize,total:_.value.total,onPageChange:r,onViewDetail:h,onDeleteItem:y},null,8,["data","loading","current-page","page-size","total"])])])}}},ee=z(W,[["__scopeId","data-v-ada55417"]]);export{ee as default};
